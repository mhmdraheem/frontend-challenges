<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat Massenger</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;1,300&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel="stylesheet">
    <script src="https://kit.fontawesome.com/9b220e24a6.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="normalize.css">
    <link rel="stylesheet" href="responsive.css">
</head>
<style>
    * {
        font-family: "Roboto", sans-serif;
        font-weight: 100;
        font-style: normal;
        --blue-color: #00B0FF;
    }

    .page {
        background-image: url(ocean.jpg);
        background-size: cover;
        height: 100vh;
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .page .overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.6);
    }

    .chatbox {
        display: flex;
        position: relative;
        z-index: 999;
        background-color: white;
        height: 400px;
    }

    .chatbox .contacts-menu {
        width: 300px;
        height: 400px;
        border-right: 1px solid #EEEEEE;
        padding-top: 20px;
        padding-bottom: 20px;
        display: inline-block;
        overflow-y: scroll;
        scrollbar-width: thin;
        
    }

    .chatbox .contacts-menu .header {
        display: flex;
        gap: 10px;
        height: 40px;
        justify-content: space-between;
        align-items: center;
        margin-left: 30px;
        margin-right: 30px;
        margin-bottom: 20px;
        position: relative;
    }

    .chatbox .contacts-menu .header input {
        height: 100%;
        width: 100%;
        padding: 10px 30px 10px 30px;
        border: none;
        background-color: #ECEFF1;
        border-radius: 10px;
        outline: none;
        min-width: 0;
        font-size: 13px;
    }

    .chatbox .contacts-menu .header i {
        width: 20px;
        height: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: grey;
        border-radius: 50%;
        font-size: 12px;
        position: absolute;
        top: calc(50% - 10px);
        left: 5px;
    }   

    .chatbox .contacts-menu ul .contact-row.hidden {
        display: none;
    }

    .chatbox .contacts-menu ul .contact-row.active,
    .chatbox .contacts-menu ul .contact-row:hover {
        background-color: var(--blue-color);
    }

    .chatbox .contacts-menu ul li {
        height: 60px;
        display: flex;
        gap: 5px;
        padding: 10px 30px;
        border-bottom: 1px solid #EEEEEE;
        cursor: pointer;
        position: relative;
    }

    .chatbox .contacts-menu .contact-row:first-of-type li {
        border-top: 1px solid #EEEEEE;
    }

    .chatbox .contacts-menu ul .contact-row.active li,
    .chatbox .contacts-menu ul .contact-row:hover li {
        border-bottom: none;
    }

    .chatbox .contacts-menu ul li img {
        width: 40px;
        max-width: 100%;
        border-radius: 50%;
    }

    .chatbox .contacts-menu ul li .details {
        flex-grow: 1;
        display: flex;
        align-self: center;
    }

    .chatbox .contacts-menu ul li .contact {
        font-size: 13px;
        display: flex;
        width: 130px;
        flex-direction: column;
        color: #1c1b1b;
    }

    .chatbox .contacts-menu ul li .contact .name {
        font-weight: 400;
        margin-bottom: 5px; 
    }

    .chatbox .contacts-menu ul li .contact .name span.matched {
        font-weight: inherit;
        color: red;
    }

    .chatbox .contacts-menu ul li .contact .msg {
        text-overflow: ellipsis;
        white-space: nowrap;
        overflow: hidden;
    }

    .chatbox .contacts-menu ul li .date {
        font-size: 10px;
        margin-left: auto;
    }

    .chatbox .contacts-menu ul .contact-row.active .contact,
    .chatbox .contacts-menu ul .contact-row:hover .contact,
    .chatbox .contacts-menu ul .contact-row.active .date,
    .chatbox .contacts-menu ul .contact-row:hover .date {
        color: white;
    }

    .massaging {
        flex-grow: 1;
        overflow-y: scroll;
        scrollbar-width: thin;
    }

    .massaging-container {
        padding: 10px 20px;
    }

    .massaging .header {
        font-size: 13px;
        background-color: #ECEFF1;
        position: sticky;
        top:0;
        left: 0;
    }

    .massaging .body {
        height: 1000px;
    }

    .massaging .footer {
        position: sticky;
        bottom: 10px;
        left: 0;
    }
    
    .massaging .footer .massaging-container {
        position: relative;
    }

    .massaging .footer .massaging-container input {
        width: 100%;
        height: 40px;
        border-radius: 5px;
        background-color: #ECEFF1;
        border:none;
        outline: none;
        padding-left: 30px;
        padding-right: 55px;
    }

    .massaging .footer .massaging-container i {
        position: absolute;
        width: 16px;
        height: 16px;
        top: calc(50% - 8px);
        cursor: pointer;
        color: grey;
    }

    .massaging .footer .massaging-container i:nth-of-type(1) {
        left: 30px;
        transform: rotate(-45deg);
    }

    .massaging .footer .massaging-container i:nth-of-type(1):hover {
        color: black;
    }

    .massaging .footer .massaging-container i:nth-of-type(2) {
        right: 55px;
    }

    .massaging .footer .massaging-container i:nth-of-type(2):hover {
        color: goldenrod;
    }

    .massaging .footer .massaging-container i:nth-of-type(3) {
        right: 30px;
    }

    .massaging .footer .massaging-container i:nth-of-type(3):hover {
        color: var(--blue-color);
    }
</style>
<body>
    <div class="page">
        <div class="overlay"></div>
        <div class="container">
            <div class="chatbox">
                <div class="contacts-menu">
                    <div class="header">
                        <i class="fa-solid fa-magnifying-glass"></i>
                        <input type="text" name="search" id="search" placeholder="Search">
                    </div>
                    <ul>
                        <!-- <div class="contact-row">
                            <li>
                                <img src="product.jpeg" alt="">
                                <div class="contact">
                                    <div class="name">xog Woofsonr</div>
                                    <div class="msg">I have forgotten how i feel</div>
                                </div>
                                <span class="date">12:25 AM</span>
                            </li>
                        </div> -->
                    </ul>
                </div>
                <div class="massaging">
                        <div class="header">
                            <div class="massaging-container">
                                To: <b>Drake</b>
                            </div>
                        </div>
                        <div class="body">
                            
                        </div>
                        <div class="footer">
                            <div class="massaging-container">
                                <input type="text" id="chat-txt">
                                <i class="fa-solid fa-paperclip"></i>
                                <i class="fa-regular fa-face-smile"></i>
                                <i class="fa-solid fa-paper-plane"></i>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>

        const myId = "1001";
        
        loadJson("./chats.json").then(json => {
            console.log(json);
            loadChats(json);
        })
            
        let contactsMenu = document.querySelector(".contacts-menu");
        let contactRows = contactsMenu.querySelectorAll(".contact-row");
    
        let search = contactsMenu.querySelector(".header input");
        search.onkeyup = (e) => {
            contactRows.forEach(contactRow => {
                let name = contactRow.querySelector(".contact .name");
                let msg = contactRow.querySelector(".contact .msg");
                let nameVal = name.innerHTML.toLowerCase();
                let msgVal = msg.innerHTML.toLowerCase();
                let searchVal = search.value.toLowerCase();
                let isSearchEmpty = search.value.lenght == 0;
                const spanStart = "<span class=\"matched\">";
                const spanEnd = "</span>";
    
                if(nameVal.includes("span")) {
                    nameVal = nameVal.replaceAll(spanStart, "").replaceAll(spanEnd, "");
                }
    
                if(isSearchEmpty || nameVal.includes(searchVal)) {
                    contactRow.classList.remove("hidden");
                    name.innerHTML = nameVal.replace(
                        searchVal, spanStart + searchVal + spanEnd
                    );
                } else {
                    contactRow.classList.add("hidden");
                }
            });
        };
    
        contactRows.forEach(contactRow => {
            contactRow.onclick = (e) => {
                let active = contactsMenu.querySelector(".contact-row.active");
                if(active) {
                    active.classList.toggle("active")
                }
                contactRow.classList.add("active");
            }
        });
    
        async function loadJson(filename) {
            let file = await fetch(filename);
            return file.json();
        }
        
        function loadChats(json) {
            // ...
            let nameDiv = document.createElement("div");
            nameDiv.classList.add("name");
            nameDiv.innerHTML = "name 123";
    
            let msgDiv = document.createElement("div");
            msgDiv.classList.add("msg");
            msgDiv.innerHTML = "message 123";
    
            let contactDiv = document.createElement("div");
            contactDiv.classList.add("contact");
            contactDiv.appendChild(nameDiv);
            contactDiv.appendChild(msgDiv);
    
            let li = document.createElement("li");
    
            let avatarImg = document.createElement("img");
            avatarImg.src = "product.jpeg";
    
            let dateSpan = document.createElement("span");
            dateSpan.classList.add("date");
            dateSpan.innerHTML = "12:25 AM";
    
            let contactRowDiv = document.createElement("div");
            contactRowDiv.classList.add("contact-row");
            contactRowDiv.appendChild(li);
    
            li.appendChild(avatarImg);
            li.appendChild(contactDiv);
            li.appendChild(dateSpan);
    
            let ul = document.querySelector("ul");
            ul.appendChild(contactRowDiv);
        }
    
        /*
        
        
        <div class="contact-row">
            <li>
                <img src="product.jpeg" alt="">
                <div class="contact">
                    <div class="name">xog Woofsonr</div>
                    <div class="msg">I have forgotten how i feel</div>
                </div>
                <span class="date">12:25 AM</span>
            </li>
        </div>
    
        */
    </script>
</body>
</html>